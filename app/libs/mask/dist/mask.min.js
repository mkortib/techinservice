
/*!
 * mask - Javascript input mask plugin
 * v0.1.0
 * https://github.com/firstandthird/mask
 * copyright First + Third 2014
 * MIT License
*/
!function(){$.declare("mask",{defaults:{ssn:{mask:"___-__-____",strict:!0,regex:/[\d_]/g},phone:{mask:"(___) ___-____",strict:!0,regex:/[\d_]/g},email:{mask:"___@___.___",strict:!1,regex:/[\w_@\.\+]/g},number:{mask:"",strict:!1,regex:/[\d_\.]/g,format:function(a){return a}}},init:function(){var a=this;this.currPos=0,this.isBackspace=!1,this.type=this.type||this.el.data("mask-type")||"_empty",this.el.on(("oninput"in document.createElement("input")?"input.mask":"keyup.mask")+" click.mask",a.proxy(a.handleInput)),this.el.on("keydown.mask",function(b){8===b.which&&(a.isBackspace=!0)}),this.el.trigger("input")},getCursorPosition:function(){var a=this.el.get(0);if(a)return document.selection&&a.focus(),"selectionStart"in a?a.selectionStart:""||Math.abs(document.selection.createRange().moveStart("character",-a.value.length))},setCursorPosition:function(a){var b=this.el.get(0);if(b.setSelectionRange)b.setSelectionRange(a,a);else if(b.createTextRange){var c=b.createTextRange();c.collapse(!0),c.moveEnd("character",a),c.moveStart("character",a),c.select()}},handleInput:function(a){var b=this.type,c=this.el.data("mask-regex"),d=this.el.val();this.currPos=this.getCursorPosition(),this.el.val(this.parse(b,d,this.currPos,a,c)),this.setCursorPosition(this.currPos)},parse:function(a,b,c,d,e){if("object"!=typeof this[a])return"";d=d||$.Event("api"),c=c||0;var f=this[a];b=b||f.mask,e=e||f.regex;var g,h,i=f.mask,j=[],k=0,l=b.length-i.length;this.isBackspace&&(b=b.substr(0,c)+"_"+b.substr(c)),"click"===d.type&&(b!==i&&!f.strict||-1===b.indexOf("_")||(this.currPos=b.indexOf("_"),c=this.currPos)),0>l&&(l=0),"api"!==d.type&&(b=b.split(""),b.splice(c,l),b=b.join(""));var m=b.match(e);for(j=m.join(""),g=0,h=j.length;h>g&&(""!==i.charAt(g+k)||!f.strict);g++)"_"!==i.charAt(g+k)&&f.strict?(k++,g--):i=i.substr(0,g+k)+j.charAt(g)+i.substr(g+k+1);return m.length!==i.match(e).length&&this.currPos--,"_"!==i.charAt(c)&&!this.isBackspace&&f.strict&&this.currPos++,this.isBackspace=!1,"function"==typeof f.format&&(i=f.format(i)),i}})}();